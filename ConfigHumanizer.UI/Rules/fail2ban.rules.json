{
  "formatName": "Fail2ban",
  "filePatterns": ["jail.conf", "jail.local", "*/jail.d/*", "fail2ban.conf"],
  "rules": [
    {
      "key": "enabled",
      "valuePattern": "(?i)^true$|^yes$",
      "severity": "GoodPractice",
      "humanDescription": "Jail enabled. This service is protected against brute-force attacks.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "enabled",
      "valuePattern": "(?i)^false$|^no$",
      "severity": "Warning",
      "humanDescription": "Jail disabled. This service is NOT protected.",
      "suggestedFix": "enabled = true",
      "fixReason": "Enable protection for this service."
    },
    {
      "key": "bantime",
      "valuePattern": "^-1$",
      "severity": "Info",
      "humanDescription": "Permanent ban configured. Offenders are banned forever.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "bantime",
      "valuePattern": "^[0-9]+$",
      "severity": "Info",
      "humanDescription": "Ban duration configured in seconds.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "maxretry",
      "valuePattern": "^[1-3]$",
      "severity": "GoodPractice",
      "humanDescription": "Strict retry limit (1-3 attempts). Quick ban on failures.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "maxretry",
      "valuePattern": "^[0-9]{2,}$",
      "severity": "Warning",
      "humanDescription": "High retry limit (10+ attempts). Too permissive for brute-force protection.",
      "suggestedFix": "maxretry = 5",
      "fixReason": "Lower the retry limit for better protection."
    },
    {
      "key": "findtime",
      "valuePattern": ".*",
      "severity": "Info",
      "humanDescription": "Time window for counting failures.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "ignoreip",
      "valuePattern": ".*127\\.0\\.0\\.1.*|.*::1.*",
      "severity": "Info",
      "humanDescription": "Localhost excluded from bans (default, safe).",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "ignoreip",
      "valuePattern": ".*0\\.0\\.0\\.0/0.*|.*::/0.*",
      "severity": "CriticalSecurity",
      "humanDescription": "All IPs ignored! Fail2ban effectively disabled.",
      "suggestedFix": "",
      "fixReason": "Remove wildcard from ignoreip."
    },
    {
      "key": "action",
      "valuePattern": ".*%(action_mwl)s.*",
      "severity": "GoodPractice",
      "humanDescription": "Ban with email notification and logs. Full audit trail.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "action",
      "valuePattern": ".*%(action_)s.*",
      "severity": "Info",
      "humanDescription": "Standard ban action configured.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "backend",
      "valuePattern": "(?i)^systemd$",
      "severity": "GoodPractice",
      "humanDescription": "Using systemd journal backend. Modern and efficient.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "banaction",
      "valuePattern": ".*iptables.*|.*nftables.*|.*firewalld.*",
      "severity": "Info",
      "humanDescription": "Firewall-based ban action configured.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "destemail",
      "valuePattern": ".*@.*",
      "severity": "GoodPractice",
      "humanDescription": "Email notifications configured for ban alerts.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": ".*sshd.*enabled",
      "valuePattern": "(?i)^true$|^yes$",
      "severity": "GoodPractice",
      "humanDescription": "SSH protection enabled. Critical for server security.",
      "suggestedFix": "",
      "fixReason": ""
    }
  ]
}
