{
  "formatName": "Terraform",
  "filePatterns": ["*.tf", "*.tfvars"],
  "formatDescription": "Terraform est un outil d'Infrastructure as Code (IaC) qui permet de d√©finir et provisionner des ressources cloud de mani√®re d√©clarative. Les fichiers .tf contiennent la d√©finition de l'infrastructure souhait√©e.",
  "rules": [
    {
      "key": "module.definition",
      "valuePattern": "Tenant.*",
      "severity": "Info",
      "humanDescription": "Module Tenant ACI : Cr√©e un tenant (locataire) dans Cisco ACI. Un tenant est un conteneur logique isol√© qui regroupe les politiques r√©seau, les profils d'application et les EPGs d'un projet ou d'une √©quipe.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "module.definition",
      "valuePattern": "BDACI.*|BD.*",
      "severity": "Info",
      "humanDescription": "Module Bridge Domain : Cr√©e un domaine de pontage dans ACI. Le Bridge Domain est un domaine de diffusion L2 qui d√©finit un segment r√©seau avec son sous-r√©seau IP, sa gateway et ses param√®tres de forwarding.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "module.definition",
      "valuePattern": "EPG.*",
      "severity": "Info",
      "humanDescription": "Module EPG (Endpoint Group) : Cr√©e un groupe de points de terminaison. L'EPG est l'unit√© de base de segmentation dans ACI - il regroupe des VMs ou serveurs ayant les m√™mes politiques de s√©curit√© et de connectivit√©.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "module.definition",
      "valuePattern": "Contract.*",
      "severity": "Info",
      "humanDescription": "Module Contract : D√©finit les r√®gles de communication entre EPGs. Un contrat sp√©cifie quels ports/protocoles sont autoris√©s entre un EPG source et un EPG destination (√©quivalent √† une r√®gle firewall interne).",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "module.definition",
      "valuePattern": "NSContract.*",
      "severity": "Info",
      "humanDescription": "Module NS Contract (North-South) : Configure les r√®gles firewall Palo Alto pour le trafic entrant/sortant du datacenter. Ces r√®gles contr√¥lent la communication entre l'infrastructure interne et les r√©seaux externes.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "module.definition",
      "valuePattern": "WEITContract.*",
      "severity": "Info",
      "humanDescription": "Module WE Inter-Tenant Contract : Permet la communication entre diff√©rents tenants ACI. Utilis√© pour connecter votre infrastructure √† des services partag√©s (monitoring, packages, etc.) g√©r√©s par d'autres √©quipes.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "module.definition",
      "valuePattern": "VM.*",
      "severity": "Info",
      "humanDescription": "Module VM : Provisionne une machine virtuelle avec l'OS, la taille (CPU/RAM), le stockage et le r√©seau sp√©cifi√©s. La VM sera automatiquement rattach√©e √† l'EPG (groupe de s√©curit√©) d√©fini.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "module.definition",
      "valuePattern": "StaticPort.*",
      "severity": "Info",
      "humanDescription": "Module Static Port : Configure un port physique sur un switch ACI pour connecter un √©quipement bare-metal ou un serveur physique √† un EPG sp√©cifique avec un VLAN d√©di√©.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "module.definition",
      "valuePattern": "NAT.*",
      "severity": "Info",
      "humanDescription": "Module NAT Rules : Configure les r√®gles de translation d'adresses sur le firewall Palo Alto. Permet d'exposer des services internes vers l'ext√©rieur ou de masquer les IPs internes.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "module.source",
      "valuePattern": ".*tenantaci.*",
      "severity": "Info",
      "humanDescription": "Source du module Tenant ACI. Ce module Terraform interne cr√©e et configure un tenant dans l'infrastructure Cisco ACI.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "module.source",
      "valuePattern": ".*bdaci.*",
      "severity": "Info",
      "humanDescription": "Source du module Bridge Domain. Configure le domaine de broadcast L2 et les sous-r√©seaux IP associ√©s.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "module.source",
      "valuePattern": ".*epg.*",
      "severity": "Info",
      "humanDescription": "Source du module EPG. Cr√©e les groupes de s√©curit√© pour segmenter et prot√©ger les workloads.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "module.source",
      "valuePattern": ".*contract.*",
      "severity": "Info",
      "humanDescription": "Source du module Contract. D√©finit les r√®gles de flux autoris√©s entre les diff√©rents EPGs.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "module.source",
      "valuePattern": ".*createvm.*",
      "severity": "Info",
      "humanDescription": "Source du module de cr√©ation VM. Provisionne les machines virtuelles sur l'infrastructure de virtualisation.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "module.source",
      "valuePattern": ".*nscontract.*",
      "severity": "Info",
      "humanDescription": "Source du module NS Contract. Configure les r√®gles firewall North-South sur Palo Alto.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "module.source",
      "valuePattern": ".*:latest.*",
      "severity": "Warning",
      "humanDescription": "‚ö†Ô∏è Le module utilise le tag 'latest'. Cela peut causer des changements inattendus si le module est mis √† jour.",
      "suggestedFix": "Utiliser une version fixe (ex: ?ref=1.0.0)",
      "fixReason": "Toujours √©pingler les versions des modules pour garantir la reproductibilit√© des d√©ploiements."
    },
    {
      "key": "module.source",
      "valuePattern": "^git::https://.*",
      "severity": "GoodPractice",
      "humanDescription": "‚úì Le module est t√©l√©charg√© via HTTPS s√©curis√© depuis un d√©p√¥t Git interne.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "module.source",
      "valuePattern": "^git::http://.*",
      "severity": "CriticalSecurity",
      "humanDescription": "üî¥ Le module utilise HTTP non chiffr√© ! Les credentials et le code peuvent √™tre intercept√©s.",
      "suggestedFix": "Remplacer http:// par https://",
      "fixReason": "Toujours utiliser HTTPS pour t√©l√©charger les modules."
    },
    {
      "key": "vm.securityGroup",
      "valuePattern": ".*_GW$",
      "severity": "Info",
      "humanDescription": "VM assign√©e au groupe Gateway. Les VMs Gateway servent de point d'entr√©e administratif (jump host/bastion). Elles re√ßoivent les connexions SSH/RDP des administrateurs et permettent d'acc√©der aux autres serveurs.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "vm.securityGroup",
      "valuePattern": ".*_AD_LDAP$",
      "severity": "Info",
      "humanDescription": "VM assign√©e au groupe AD/LDAP. Contient les contr√¥leurs de domaine Active Directory et/ou serveurs LDAP. Ces serveurs g√®rent l'authentification et les autorisations des utilisateurs et machines.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "vm.securityGroup",
      "valuePattern": ".*_SERVICES$",
      "severity": "Info",
      "humanDescription": "VM assign√©e au groupe Services. H√©berge les services d'infrastructure partag√©s : WSUS (mises √† jour Windows), Katello (packages Linux), PKI, syslog, etc.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "vm.securityGroup",
      "valuePattern": ".*_SECU_REPO$",
      "severity": "Info",
      "humanDescription": "VM assign√©e au groupe Security Repository. Contient les outils de s√©curit√© : Wazuh (SIEM/EDR), collecteurs de logs, scanners de vuln√©rabilit√©s. Zone sensible √† prot√©ger.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "vm.securityGroup",
      "valuePattern": ".*_EXCHANGE$|.*_ECH.*",
      "severity": "Info",
      "humanDescription": "VM assign√©e au groupe Exchange/Communication. H√©berge les proxies, relais ou services de communication avec l'ext√©rieur.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "vm.os",
      "valuePattern": "(?i)windows2022.*",
      "severity": "Info",
      "humanDescription": "Syst√®me d'exploitation : Windows Server 2022. Version LTS avec support jusqu'en 2031. Inclut les derni√®res fonctionnalit√©s de s√©curit√© (Secured-core, TLS 1.3).",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "vm.os",
      "valuePattern": "(?i)windows2019.*",
      "severity": "Info",
      "humanDescription": "Syst√®me d'exploitation : Windows Server 2019. Version stable avec support mainstream jusqu'en 2024, support √©tendu jusqu'en 2029.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "vm.os",
      "valuePattern": "(?i)rhel9.*",
      "severity": "Info",
      "humanDescription": "Syst√®me d'exploitation : Red Hat Enterprise Linux 9. Derni√®re version majeure RHEL avec support jusqu'en 2032. Kernel 5.14, Python 3.9, OpenSSL 3.0.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "vm.os",
      "valuePattern": "(?i)rhel8.*",
      "severity": "Info",
      "humanDescription": "Syst√®me d'exploitation : Red Hat Enterprise Linux 8. Version stable avec support jusqu'en 2029. Kernel 4.18, Python 3.6/3.8.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "vm.netClass",
      "valuePattern": "GOLD.*",
      "severity": "Info",
      "humanDescription": "Classe r√©seau GOLD : Bande passante garantie de 1000 Mbps, latence faible, priorit√© haute. Recommand√© pour les workloads critiques.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "vm.netClass",
      "valuePattern": "SILVER.*",
      "severity": "Info",
      "humanDescription": "Classe r√©seau SILVER : Bande passante standard, priorit√© moyenne. Adapt√© pour les workloads non-critiques.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "vm.storClass",
      "valuePattern": "GOLD.*",
      "severity": "Info",
      "humanDescription": "Classe stockage GOLD : Stockage haute performance avec 2000+ IOPS garantis. Recommand√© pour les bases de donn√©es et applications I/O intensives.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "vm.storClass",
      "valuePattern": "SILVER.*",
      "severity": "Info",
      "humanDescription": "Classe stockage SILVER : Stockage standard avec performances correctes. Adapt√© pour les serveurs d'application classiques.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "aci.fabric",
      "valuePattern": ".*DC1.*",
      "severity": "Info",
      "humanDescription": "Fabric ACI du Datacenter 1. L'infrastructure sera d√©ploy√©e sur le contr√¥leur APIC du site DC1.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "aci.fabric",
      "valuePattern": ".*DC2.*",
      "severity": "Info",
      "humanDescription": "Fabric ACI du Datacenter 2. L'infrastructure sera d√©ploy√©e sur le contr√¥leur APIC du site DC2.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "contract.epg",
      "valuePattern": ".*",
      "severity": "Info",
      "humanDescription": "R√©f√©rence √† un EPG dans un contrat. Ce contrat autorise le trafic vers ou depuis cet Endpoint Group.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "contract.tenant",
      "valuePattern": "MONITOR.*",
      "severity": "Info",
      "humanDescription": "Contrat inter-tenant vers le tenant Monitoring. Permet d'envoyer les m√©triques et alertes vers l'infrastructure de supervision centralis√©e (Zabbix, Prometheus, etc.).",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "contract.tenant",
      "valuePattern": "SHARED.*|CPDC.*",
      "severity": "Info",
      "humanDescription": "Contrat inter-tenant vers les services partag√©s. Permet d'acc√©der aux ressources communes : serveur Chocolatey, repositories, DNS, NTP, etc.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "firewall.ports",
      "valuePattern": ".*TCP_22.*",
      "severity": "Info",
      "humanDescription": "Port SSH (TCP/22) autoris√©. Permet l'administration √† distance s√©curis√©e des serveurs Linux.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "firewall.ports",
      "valuePattern": ".*TCP_3389.*",
      "severity": "Info",
      "humanDescription": "Port RDP (TCP/3389) autoris√©. Permet l'administration √† distance graphique des serveurs Windows.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "firewall.ports",
      "valuePattern": ".*TCP_443.*",
      "severity": "Info",
      "humanDescription": "Port HTTPS (TCP/443) autoris√©. Communication web s√©curis√©e par TLS.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "firewall.ports",
      "valuePattern": ".*TCP_445.*",
      "severity": "Warning",
      "humanDescription": "‚ö†Ô∏è Port SMB (TCP/445) autoris√©. Partage de fichiers Windows. V√©rifier que SMBv1 est d√©sactiv√© et SMB signing activ√©.",
      "suggestedFix": "",
      "fixReason": "SMB est souvent exploit√© dans les attaques ransomware pour la propagation lat√©rale."
    },
    {
      "key": "firewall.ports",
      "valuePattern": ".*TCP_88.*|.*UDP_88.*",
      "severity": "Info",
      "humanDescription": "Port Kerberos (TCP/UDP 88) autoris√©. Protocole d'authentification Active Directory.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "firewall.ports",
      "valuePattern": ".*TCP_389.*|.*UDP_389.*",
      "severity": "Info",
      "humanDescription": "Port LDAP (TCP/UDP 389) autoris√©. Requ√™tes d'annuaire Active Directory non chiffr√©es.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "firewall.ports",
      "valuePattern": ".*TCP_636.*",
      "severity": "GoodPractice",
      "humanDescription": "‚úì Port LDAPS (TCP/636) autoris√©. Requ√™tes LDAP chiffr√©es par TLS - plus s√©curis√© que LDAP simple.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "firewall.ports",
      "valuePattern": ".*TCP_5985.*|.*TCP_5986.*",
      "severity": "Info",
      "humanDescription": "Ports WinRM (TCP/5985-5986) autoris√©s. Administration PowerShell √† distance des serveurs Windows. 5986 = HTTPS (recommand√©).",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "firewall.ports",
      "valuePattern": ".*TCP_1514.*|.*TCP_1515.*",
      "severity": "Info",
      "humanDescription": "Ports Wazuh Agent (TCP/1514-1515) autoris√©s. Communication entre les agents Wazuh et le serveur SIEM pour la collecte des √©v√©nements de s√©curit√©.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "firewall.ports",
      "valuePattern": ".*TCP_10050.*|.*TCP_10051.*",
      "severity": "Info",
      "humanDescription": "Ports Zabbix (TCP/10050-10051) autoris√©s. 10050 = agent passif (pull), 10051 = agent actif (push). Monitoring de l'infrastructure.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "firewall.ports",
      "valuePattern": ".*TCP_8530.*|.*TCP_8531.*",
      "severity": "Info",
      "humanDescription": "Ports WSUS (TCP/8530-8531) autoris√©s. Windows Server Update Services - distribution des mises √† jour Microsoft.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "firewall.ports",
      "valuePattern": ".*TCP_8140.*",
      "severity": "Info",
      "humanDescription": "Port Puppet/Katello (TCP/8140) autoris√©. Communication agent-serveur pour la gestion de configuration et packages Linux.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "firewall.ports",
      "valuePattern": ".*TCP_49152-65535.*",
      "severity": "Warning",
      "humanDescription": "‚ö†Ô∏è Plage de ports dynamiques Windows (49152-65535) autoris√©e. N√©cessaire pour AD/RPC mais augmente la surface d'attaque.",
      "suggestedFix": "",
      "fixReason": "Cette plage large est requise pour les communications RPC d'Active Directory."
    },
    {
      "key": "firewall.json_file",
      "valuePattern": ".*",
      "severity": "Info",
      "humanDescription": "R√©f√©rence vers un fichier JSON contenant les r√®gles firewall North-South (Palo Alto). Ces r√®gles d√©finissent le trafic autoris√© entre l'infrastructure et l'ext√©rieur.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "workspace.PROD.*",
      "valuePattern": ".*",
      "severity": "Info",
      "humanDescription": "Configuration pour l'environnement de PRODUCTION. Les changements dans cet environnement impactent les services en production.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "workspace.DEV.*",
      "valuePattern": ".*",
      "severity": "Info",
      "humanDescription": "Configuration pour l'environnement de D√âVELOPPEMENT. Environnement de test isol√© de la production.",
      "suggestedFix": "",
      "fixReason": ""
    }
  ]
}
