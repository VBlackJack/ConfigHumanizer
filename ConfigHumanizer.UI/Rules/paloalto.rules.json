{
  "formatName": "PaloAlto",
  "filePatterns": ["*FW_Rules*.json", "*NAT_Rules*.json", "*fw_rules*.json"],
  "formatDescription": "Fichier de r√®gles firewall Palo Alto au format JSON. D√©finit les r√®gles North-South (entr√©e/sortie du datacenter) qui contr√¥lent le trafic entre l'infrastructure interne et les r√©seaux externes (Internet, autres sites, partenaires).",
  "rules": [
    {
      "key": "firewall.tag_color",
      "valuePattern": "green",
      "severity": "GoodPractice",
      "humanDescription": "‚úì R√®gles marqu√©es en vert : Indique que ces r√®gles ont √©t√© valid√©es et approuv√©es par l'√©quipe s√©curit√©.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "firewall.tag_color",
      "valuePattern": "red",
      "severity": "Warning",
      "humanDescription": "‚ö†Ô∏è R√®gles marqu√©es en rouge : Ces r√®gles sont temporaires ou en attente de validation. √Ä revoir et approuver.",
      "suggestedFix": "Faire valider les r√®gles et changer le tag en vert",
      "fixReason": "Les r√®gles non valid√©es peuvent repr√©senter un risque de s√©curit√©."
    },
    {
      "key": "firewall.tag_color",
      "valuePattern": "yellow",
      "severity": "Info",
      "humanDescription": "R√®gles marqu√©es en jaune : R√®gles en cours de r√©vision ou de migration.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.name",
      "valuePattern": ".*KMS.*",
      "severity": "Info",
      "humanDescription": "R√®gle d'activation KMS : Permet aux serveurs Windows de contacter le serveur KMS (Key Management Service) pour activer leur licence. Port TCP/1688.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.name",
      "valuePattern": ".*WSUS.*",
      "severity": "Info",
      "humanDescription": "R√®gle WSUS (Windows Server Update Services) : Permet aux serveurs Windows de t√©l√©charger les mises √† jour de s√©curit√© depuis le serveur WSUS interne. Ports TCP/8530-8531.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.name",
      "valuePattern": ".*Katello.*|.*RHEL.*",
      "severity": "Info",
      "humanDescription": "R√®gle Katello/Satellite : Permet aux serveurs Linux (RHEL) de t√©l√©charger les packages et mises √† jour depuis le serveur Katello/Satellite. Port TCP/443.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.name",
      "valuePattern": ".*SSH.*",
      "severity": "Info",
      "humanDescription": "R√®gle SSH : Autorise les connexions SSH (Secure Shell) pour l'administration √† distance des serveurs Linux. Port TCP/22.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.name",
      "valuePattern": ".*RDP.*",
      "severity": "Info",
      "humanDescription": "R√®gle RDP (Remote Desktop Protocol) : Autorise les connexions bureau √† distance pour l'administration des serveurs Windows. Port TCP/3389.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.name",
      "valuePattern": ".*AD.*|.*LDAP.*",
      "severity": "Info",
      "humanDescription": "R√®gle Active Directory/LDAP : Permet la communication avec les contr√¥leurs de domaine pour l'authentification, les politiques de groupe et les requ√™tes d'annuaire.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.name",
      "valuePattern": ".*Replication.*|.*Failover.*",
      "severity": "Info",
      "humanDescription": "R√®gle de r√©plication inter-site : Permet la synchronisation des donn√©es entre datacenters (AD, bases de donn√©es, fichiers). Critique pour la haute disponibilit√©.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.name",
      "valuePattern": ".*SOC.*|.*soc.*|.*Concentrator.*",
      "severity": "Info",
      "humanDescription": "R√®gle SOC (Security Operations Center) : Permet l'envoi des logs de s√©curit√© vers le SOC pour analyse et d√©tection des menaces. Ports TCP/6514 (syslog TLS), TCP/1545.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.name",
      "valuePattern": ".*Chocolatey.*",
      "severity": "Info",
      "humanDescription": "R√®gle Chocolatey : Permet aux serveurs Windows d'acc√©der au serveur Chocolatey interne pour installer des packages logiciels. Port TCP/80.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.name",
      "valuePattern": ".*NTLite.*",
      "severity": "Info",
      "humanDescription": "R√®gle NTLite : Permet au serveur NTLite de t√©l√©charger les composants depuis le site du vendeur pour la personnalisation des images Windows.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.name",
      "valuePattern": ".*KeePass.*",
      "severity": "Info",
      "humanDescription": "R√®gle KeePass : Permet l'acc√®s au partage de fichiers contenant les bases KeePass (gestionnaire de mots de passe d'√©quipe). Port TCP/445 (SMB).",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.name",
      "valuePattern": ".*CRL.*",
      "severity": "Info",
      "humanDescription": "R√®gle CRL (Certificate Revocation List) : Permet de v√©rifier si un certificat a √©t√© r√©voqu√© aupr√®s du serveur PKI. Port TCP/80. Essentiel pour la validation des certificats.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.name",
      "valuePattern": ".*Internet.*",
      "severity": "Warning",
      "humanDescription": "‚ö†Ô∏è R√®gle d'acc√®s Internet : Cette r√®gle autorise l'acc√®s vers Internet. V√©rifier que seuls les serveurs n√©cessaires sont concern√©s.",
      "suggestedFix": "",
      "fixReason": "L'acc√®s Internet direct doit √™tre limit√© et contr√¥l√©."
    },
    {
      "key": "fw_rule.source_any",
      "valuePattern": "any",
      "severity": "Warning",
      "humanDescription": "‚ö†Ô∏è Source = ANY : Cette r√®gle accepte le trafic depuis n'importe quelle source. Potentiellement trop permissif.",
      "suggestedFix": "Restreindre aux IPs ou r√©seaux sources sp√©cifiques",
      "fixReason": "Les r√®gles avec source 'any' augmentent la surface d'attaque."
    },
    {
      "key": "fw_rule.dest_any",
      "valuePattern": "any",
      "severity": "CriticalSecurity",
      "humanDescription": "üî¥ Destination = ANY : Cette r√®gle autorise le trafic vers n'importe quelle destination. TR√àS RISQU√â - peut permettre l'exfiltration de donn√©es.",
      "suggestedFix": "D√©finir les destinations sp√©cifiques autoris√©es",
      "fixReason": "Les r√®gles avec destination 'any' permettent √† un attaquant de communiquer avec n'importe quel serveur externe."
    },
    {
      "key": "fw_rule.source",
      "valuePattern": ".*\\/24$",
      "severity": "Info",
      "humanDescription": "Source = sous-r√©seau /24 (256 adresses). Toutes les machines de ce sous-r√©seau peuvent utiliser cette r√®gle.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.source",
      "valuePattern": ".*\\/26$",
      "severity": "Info",
      "humanDescription": "Source = sous-r√©seau /26 (64 adresses). Sous-r√©seau de taille moyenne, typique pour un EPG/segment applicatif.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.source",
      "valuePattern": "^[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+$",
      "severity": "GoodPractice",
      "humanDescription": "‚úì Source = IP unique. R√®gle pr√©cise limit√©e √† un seul serveur - bonne pratique de moindre privil√®ge.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.dest",
      "valuePattern": "^[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+$",
      "severity": "GoodPractice",
      "humanDescription": "‚úì Destination = IP unique. R√®gle pr√©cise limit√©e √† un seul serveur cible - bonne pratique.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.service",
      "valuePattern": ".*",
      "severity": "Info",
      "humanDescription": "Services/ports autoris√©s par cette r√®gle. Format: PROTOCOL_PORT (ex: TCP_443 = HTTPS).",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.source_zone",
      "valuePattern": "any",
      "severity": "Warning",
      "humanDescription": "‚ö†Ô∏è Zone source = ANY. La r√®gle s'applique depuis toutes les zones de s√©curit√©. Pr√©f√©rer une zone sp√©cifique.",
      "suggestedFix": "",
      "fixReason": "Les politiques bas√©es sur les zones offrent un meilleur contr√¥le."
    },
    {
      "key": "fw_rule.source_zone",
      "valuePattern": "prod.*",
      "severity": "Info",
      "humanDescription": "Zone source = Production. Le trafic provient de la zone de production du datacenter.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.dest_zone",
      "valuePattern": "any",
      "severity": "Warning",
      "humanDescription": "‚ö†Ô∏è Zone destination = ANY. La r√®gle autorise le trafic vers toutes les zones. Potentiellement trop ouvert.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.port.TCP_22",
      "valuePattern": ".*",
      "severity": "Info",
      "humanDescription": "Port SSH (TCP/22) : Acc√®s shell s√©curis√© pour l'administration des serveurs Linux/Unix. Chiffr√© par d√©faut.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.port.TCP_23",
      "valuePattern": ".*",
      "severity": "CriticalSecurity",
      "humanDescription": "üî¥ Port Telnet (TCP/23) : Protocole NON CHIFFR√â ! Les mots de passe transitent en clair sur le r√©seau.",
      "suggestedFix": "Remplacer Telnet par SSH (TCP/22)",
      "fixReason": "Telnet est un protocole obsol√®te et dangereux. Utiliser SSH √† la place."
    },
    {
      "key": "fw_rule.port.TCP_3389",
      "valuePattern": ".*",
      "severity": "Warning",
      "humanDescription": "‚ö†Ô∏è Port RDP (TCP/3389) : Bureau √† distance Windows. Cible fr√©quente des attaques par force brute.",
      "suggestedFix": "",
      "fixReason": "Prot√©ger RDP avec NLA (Network Level Authentication) et limiter les sources autoris√©es."
    },
    {
      "key": "fw_rule.port.TCP_445",
      "valuePattern": ".*",
      "severity": "Warning",
      "humanDescription": "‚ö†Ô∏è Port SMB (TCP/445) : Partage de fichiers Windows. Vecteur d'attaque courant (WannaCry, EternalBlue).",
      "suggestedFix": "",
      "fixReason": "D√©sactiver SMBv1, activer SMB signing, et restreindre aux r√©seaux de confiance."
    },
    {
      "key": "fw_rule.port.TCP_1433",
      "valuePattern": ".*",
      "severity": "Warning",
      "humanDescription": "‚ö†Ô∏è Port SQL Server (TCP/1433) : Base de donn√©es Microsoft SQL Server. Ne jamais exposer directement.",
      "suggestedFix": "",
      "fixReason": "Les bases de donn√©es ne doivent √™tre accessibles que depuis les serveurs applicatifs."
    },
    {
      "key": "fw_rule.port.TCP_3306",
      "valuePattern": ".*",
      "severity": "Warning",
      "humanDescription": "‚ö†Ô∏è Port MySQL (TCP/3306) : Base de donn√©es MySQL/MariaDB. Ne jamais exposer directement.",
      "suggestedFix": "",
      "fixReason": "Restreindre l'acc√®s aux serveurs applicatifs uniquement."
    },
    {
      "key": "fw_rule.port.TCP_5432",
      "valuePattern": ".*",
      "severity": "Warning",
      "humanDescription": "‚ö†Ô∏è Port PostgreSQL (TCP/5432) : Base de donn√©es PostgreSQL. Prot√©ger avec SSL et authentification forte.",
      "suggestedFix": "",
      "fixReason": "Ne pas exposer les bases de donn√©es directement sur le r√©seau."
    },
    {
      "key": "fw_rule.port.TCP_27017",
      "valuePattern": ".*",
      "severity": "Warning",
      "humanDescription": "‚ö†Ô∏è Port MongoDB (TCP/27017) : Base de donn√©es NoSQL. ATTENTION : MongoDB sans auth est un risque critique.",
      "suggestedFix": "",
      "fixReason": "Toujours activer l'authentification MongoDB et restreindre l'acc√®s r√©seau."
    },
    {
      "key": "fw_rule.port.TCP_6379",
      "valuePattern": ".*",
      "severity": "Warning",
      "humanDescription": "‚ö†Ô∏è Port Redis (TCP/6379) : Cache/base de donn√©es en m√©moire. Souvent d√©ploy√© sans authentification.",
      "suggestedFix": "",
      "fixReason": "Configurer un mot de passe Redis et restreindre l'acc√®s au r√©seau local."
    },
    {
      "key": "fw_rule.port.TCP_21",
      "valuePattern": ".*",
      "severity": "CriticalSecurity",
      "humanDescription": "üî¥ Port FTP (TCP/21) : Protocole de transfert NON CHIFFR√â ! Utiliser SFTP ou FTPS √† la place.",
      "suggestedFix": "Remplacer FTP par SFTP (TCP/22) ou FTPS (TCP/990)",
      "fixReason": "FTP transmet les fichiers et mots de passe en clair."
    },
    {
      "key": "fw_rule.port.TCP_80",
      "valuePattern": ".*",
      "severity": "Info",
      "humanDescription": "Port HTTP (TCP/80) : Trafic web non chiffr√©. Acceptable pour les services internes ou redirection vers HTTPS.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.port.TCP_443",
      "valuePattern": ".*",
      "severity": "GoodPractice",
      "humanDescription": "‚úì Port HTTPS (TCP/443) : Trafic web chiffr√© par TLS. M√©thode recommand√©e pour les communications web.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.port.TCP_636",
      "valuePattern": ".*",
      "severity": "GoodPractice",
      "humanDescription": "‚úì Port LDAPS (TCP/636) : LDAP s√©curis√© par TLS. Pr√©f√©rer LDAPS √† LDAP (389) pour les requ√™tes AD.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.port.TCP_1688",
      "valuePattern": ".*",
      "severity": "Info",
      "humanDescription": "Port KMS (TCP/1688) : Service d'activation des licences Microsoft (Windows, Office).",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.port.TCP_6514",
      "valuePattern": ".*",
      "severity": "GoodPractice",
      "humanDescription": "‚úì Port Syslog TLS (TCP/6514) : Envoi de logs chiffr√© vers un serveur syslog/SIEM. Plus s√©curis√© que UDP/514.",
      "suggestedFix": "",
      "fixReason": ""
    },
    {
      "key": "fw_rule.port.wide_range",
      "valuePattern": ".*",
      "severity": "Warning",
      "humanDescription": "‚ö†Ô∏è Plage de ports √©tendue (49152-65535) : Ports dynamiques RPC Windows. N√©cessaire pour AD mais augmente la surface d'attaque.",
      "suggestedFix": "",
      "fixReason": "Cette plage est requise pour les communications RPC Active Directory."
    }
  ]
}
