{
  "formatName": "Rsyslog",
  "description": "Configuration du daemon rsyslog",
  "version": "1.0",
  "filePatterns": ["rsyslog.conf", "*/rsyslog.d/*"],
  "fileExtensions": [".conf"],
  "syntax": "SpaceSeparated",
  "commentChar": "#",
  "keyValueSeparator": " ",
  "documentationUrl": "https://www.rsyslog.com/doc/",
  "parameterCategories": [
    {
      "name": "Modules",
      "description": "Chargement des modules rsyslog",
      "icon": "üîå",
      "order": 1,
      "parameters": [
        {
          "key": "$ModLoad imuxsock",
          "displayName": "Socket Unix local",
          "description": "Re√ßoit les logs via /dev/log (socket Unix)",
          "dataType": "String",
          "defaultValue": "$ModLoad imuxsock",
          "example": "$ModLoad imuxsock",
          "tags": ["module", "local"]
        },
        {
          "key": "$ModLoad imjournal",
          "displayName": "Journal systemd",
          "description": "Re√ßoit les logs depuis le journal systemd",
          "dataType": "String",
          "defaultValue": "$ModLoad imjournal",
          "example": "$ModLoad imjournal",
          "tags": ["module", "systemd"]
        },
        {
          "key": "$ModLoad imklog",
          "displayName": "Logs kernel",
          "description": "Re√ßoit les messages du kernel",
          "dataType": "String",
          "defaultValue": "$ModLoad imklog",
          "example": "$ModLoad imklog",
          "tags": ["module", "kernel"]
        },
        {
          "key": "$ModLoad imudp",
          "displayName": "R√©ception UDP",
          "description": "Active la r√©ception de logs via UDP (non fiable)",
          "dataType": "String",
          "example": "$ModLoad imudp",
          "securityLevel": "Warning",
          "tags": ["module", "r√©seau", "UDP"]
        },
        {
          "key": "$ModLoad imtcp",
          "displayName": "R√©ception TCP",
          "description": "Active la r√©ception de logs via TCP (fiable)",
          "dataType": "String",
          "example": "$ModLoad imtcp",
          "tags": ["module", "r√©seau", "TCP"]
        },
        {
          "key": "$ModLoad imrelp",
          "displayName": "R√©ception RELP",
          "description": "Active RELP (Reliable Event Logging Protocol)",
          "dataType": "String",
          "example": "$ModLoad imrelp",
          "securityLevel": "GoodPractice",
          "tags": ["module", "r√©seau", "RELP"]
        },
        {
          "key": "$ModLoad omrelp",
          "displayName": "Envoi RELP",
          "description": "Active l'envoi de logs via RELP",
          "dataType": "String",
          "example": "$ModLoad omrelp",
          "tags": ["module", "r√©seau"]
        }
      ]
    },
    {
      "name": "R√©ception r√©seau",
      "description": "Configuration de la r√©ception de logs distants",
      "icon": "üåê",
      "order": 2,
      "parameters": [
        {
          "key": "$UDPServerRun",
          "displayName": "Port UDP",
          "description": "Port d'√©coute pour les logs UDP",
          "dataType": "Port",
          "defaultValue": 514,
          "example": "$UDPServerRun 514",
          "securityLevel": "Warning",
          "tags": ["r√©seau", "UDP"]
        },
        {
          "key": "$InputTCPServerRun",
          "displayName": "Port TCP",
          "description": "Port d'√©coute pour les logs TCP",
          "dataType": "Port",
          "defaultValue": 514,
          "example": "$InputTCPServerRun 514",
          "tags": ["r√©seau", "TCP"]
        },
        {
          "key": "$InputRELPServerRun",
          "displayName": "Port RELP",
          "description": "Port d'√©coute pour les logs RELP",
          "dataType": "Port",
          "defaultValue": 2514,
          "example": "$InputRELPServerRun 2514",
          "tags": ["r√©seau", "RELP"]
        },
        {
          "key": "$AllowedSender",
          "displayName": "Exp√©diteurs autoris√©s",
          "description": "Restreint les sources de logs autoris√©es",
          "dataType": "String",
          "example": "$AllowedSender UDP, 192.168.1.0/24",
          "tags": ["s√©curit√©", "ACL"]
        }
      ]
    },
    {
      "name": "Fichiers",
      "description": "Param√®tres des fichiers de logs",
      "icon": "üìÅ",
      "order": 3,
      "parameters": [
        {
          "key": "$WorkDirectory",
          "displayName": "R√©pertoire de travail",
          "description": "R√©pertoire pour les fichiers temporaires et queues",
          "dataType": "Path",
          "defaultValue": "/var/lib/rsyslog",
          "example": "$WorkDirectory /var/lib/rsyslog",
          "tags": ["fichiers"]
        },
        {
          "key": "$FileOwner",
          "displayName": "Propri√©taire des fichiers",
          "description": "Utilisateur propri√©taire des fichiers de log cr√©√©s",
          "dataType": "String",
          "defaultValue": "root",
          "example": "$FileOwner syslog",
          "tags": ["fichiers", "permissions"]
        },
        {
          "key": "$FileGroup",
          "displayName": "Groupe des fichiers",
          "description": "Groupe propri√©taire des fichiers de log cr√©√©s",
          "dataType": "String",
          "defaultValue": "adm",
          "example": "$FileGroup adm",
          "tags": ["fichiers", "permissions"]
        },
        {
          "key": "$FileCreateMode",
          "displayName": "Permissions des fichiers",
          "description": "Permissions Unix des fichiers de log cr√©√©s",
          "dataType": "Enum",
          "defaultValue": "0640",
          "enumValues": [
            { "value": "0600", "displayName": "0600 (propri√©taire seul)", "severity": "GoodPractice" },
            { "value": "0640", "displayName": "0640 (groupe lecture)", "severity": "GoodPractice" },
            { "value": "0644", "displayName": "0644 (tous lecture)", "severity": "Warning" }
          ],
          "example": "$FileCreateMode 0640",
          "tags": ["fichiers", "permissions", "s√©curit√©"]
        },
        {
          "key": "$DirCreateMode",
          "displayName": "Permissions des r√©pertoires",
          "description": "Permissions Unix des r√©pertoires cr√©√©s",
          "dataType": "Enum",
          "defaultValue": "0755",
          "enumValues": [
            { "value": "0700", "displayName": "0700 (propri√©taire seul)", "severity": "GoodPractice" },
            { "value": "0750", "displayName": "0750 (groupe acc√®s)", "severity": "GoodPractice" },
            { "value": "0755", "displayName": "0755 (tous acc√®s)", "severity": "Info" }
          ],
          "example": "$DirCreateMode 0750",
          "tags": ["fichiers", "permissions"]
        },
        {
          "key": "$Umask",
          "displayName": "Umask",
          "description": "Masque de cr√©ation de fichiers",
          "dataType": "String",
          "defaultValue": "0000",
          "example": "$Umask 0022",
          "tags": ["fichiers", "permissions"]
        }
      ]
    },
    {
      "name": "Envoi distant",
      "description": "Configuration de l'envoi vers des serveurs distants",
      "icon": "üì§",
      "order": 4,
      "parameters": [
        {
          "key": "*.* @@",
          "displayName": "Envoi TCP (tous logs)",
          "description": "Envoie tous les logs via TCP vers un serveur distant",
          "dataType": "String",
          "example": "*.* @@192.168.1.100:514",
          "securityLevel": "GoodPractice",
          "tags": ["distant", "TCP"]
        },
        {
          "key": "*.* @",
          "displayName": "Envoi UDP (tous logs)",
          "description": "Envoie tous les logs via UDP vers un serveur distant",
          "dataType": "String",
          "example": "*.* @192.168.1.100:514",
          "securityLevel": "Warning",
          "tags": ["distant", "UDP"]
        },
        {
          "key": "auth,authpriv.* @@",
          "displayName": "Envoi auth TCP",
          "description": "Envoie les logs d'authentification via TCP",
          "dataType": "String",
          "example": "auth,authpriv.* @@logserver.example.com:514",
          "tags": ["distant", "s√©curit√©"]
        },
        {
          "key": ":omrelp:",
          "displayName": "Envoi RELP",
          "description": "Envoie les logs via RELP (plus fiable)",
          "dataType": "String",
          "example": "*.* :omrelp:logserver.example.com:2514",
          "securityLevel": "GoodPractice",
          "tags": ["distant", "RELP"]
        }
      ]
    },
    {
      "name": "R√®gles de routage",
      "description": "R√®gles de routage des logs vers fichiers locaux",
      "icon": "üìã",
      "order": 5,
      "parameters": [
        {
          "key": "auth,authpriv.*",
          "displayName": "Logs authentification",
          "description": "Enregistre les logs d'authentification",
          "dataType": "String",
          "defaultValue": "/var/log/auth.log",
          "example": "auth,authpriv.* /var/log/auth.log",
          "tags": ["routage", "s√©curit√©"]
        },
        {
          "key": "*.*;auth,authpriv.none",
          "displayName": "Logs syst√®me (sauf auth)",
          "description": "Tous les logs sauf authentification",
          "dataType": "String",
          "defaultValue": "/var/log/syslog",
          "example": "*.*;auth,authpriv.none /var/log/syslog",
          "tags": ["routage"]
        },
        {
          "key": "kern.*",
          "displayName": "Logs kernel",
          "description": "Messages du noyau Linux",
          "dataType": "String",
          "defaultValue": "/var/log/kern.log",
          "example": "kern.* /var/log/kern.log",
          "tags": ["routage", "kernel"]
        },
        {
          "key": "mail.*",
          "displayName": "Logs mail",
          "description": "Logs du serveur de messagerie",
          "dataType": "String",
          "defaultValue": "/var/log/mail.log",
          "example": "mail.* /var/log/mail.log",
          "tags": ["routage", "mail"]
        },
        {
          "key": "cron.*",
          "displayName": "Logs cron",
          "description": "Logs des t√¢ches planifi√©es",
          "dataType": "String",
          "defaultValue": "/var/log/cron.log",
          "example": "cron.* /var/log/cron.log",
          "tags": ["routage", "cron"]
        },
        {
          "key": "*.emerg",
          "displayName": "Urgences",
          "description": "Messages d'urgence √† tous les utilisateurs",
          "dataType": "String",
          "defaultValue": ":omusrmsg:*",
          "example": "*.emerg :omusrmsg:*",
          "tags": ["routage", "urgence"]
        },
        {
          "key": "local0.*",
          "displayName": "Facility local0",
          "description": "Logs personnalis√©s local0",
          "dataType": "String",
          "example": "local0.* /var/log/local0.log",
          "tags": ["routage", "custom"]
        },
        {
          "key": "local7.*",
          "displayName": "Facility local7",
          "description": "Logs personnalis√©s local7 (souvent boot)",
          "dataType": "String",
          "example": "local7.* /var/log/boot.log",
          "tags": ["routage", "custom"]
        }
      ]
    },
    {
      "name": "Queue",
      "description": "Configuration des files d'attente",
      "icon": "üìä",
      "order": 6,
      "parameters": [
        {
          "key": "$ActionQueueType",
          "displayName": "Type de queue",
          "description": "Type de file d'attente pour les actions",
          "dataType": "Enum",
          "defaultValue": "Direct",
          "enumValues": [
            { "value": "Direct", "displayName": "Direct (synchrone)", "severity": "Info" },
            { "value": "LinkedList", "displayName": "LinkedList (async m√©moire)", "severity": "GoodPractice" },
            { "value": "FixedArray", "displayName": "FixedArray (async rapide)", "severity": "GoodPractice" },
            { "value": "Disk", "displayName": "Disk (persistant)", "severity": "GoodPractice" }
          ],
          "example": "$ActionQueueType LinkedList",
          "tags": ["queue", "performance"]
        },
        {
          "key": "$ActionQueueFileName",
          "displayName": "Fichier de queue",
          "description": "Nom de base du fichier de queue sur disque",
          "dataType": "String",
          "example": "$ActionQueueFileName fwdRule1",
          "tags": ["queue", "persistance"]
        },
        {
          "key": "$ActionQueueMaxDiskSpace",
          "displayName": "Espace disque max",
          "description": "Espace disque maximum pour la queue",
          "dataType": "Size",
          "defaultValue": "1g",
          "example": "$ActionQueueMaxDiskSpace 1g",
          "tags": ["queue", "limite"]
        },
        {
          "key": "$ActionQueueSaveOnShutdown",
          "displayName": "Sauvegarder √† l'arr√™t",
          "description": "Sauvegarde la queue lors de l'arr√™t du service",
          "dataType": "Enum",
          "enumValues": [
            { "value": "on", "displayName": "Activ√©", "severity": "GoodPractice" },
            { "value": "off", "displayName": "D√©sactiv√©", "severity": "Warning" }
          ],
          "example": "$ActionQueueSaveOnShutdown on",
          "tags": ["queue", "persistance"]
        },
        {
          "key": "$ActionResumeRetryCount",
          "displayName": "Tentatives de reprise",
          "description": "Nombre de tentatives de reconnexion (-1 = infini)",
          "dataType": "Integer",
          "defaultValue": -1,
          "example": "$ActionResumeRetryCount -1",
          "tags": ["queue", "fiabilit√©"]
        }
      ]
    },
    {
      "name": "TLS/S√©curit√©",
      "description": "Configuration du chiffrement TLS",
      "icon": "üîí",
      "order": 7,
      "parameters": [
        {
          "key": "$DefaultNetstreamDriver",
          "displayName": "Driver r√©seau",
          "description": "Driver de chiffrement par d√©faut",
          "dataType": "Enum",
          "enumValues": [
            { "value": "gtls", "displayName": "GnuTLS", "severity": "GoodPractice" },
            { "value": "ossl", "displayName": "OpenSSL", "severity": "GoodPractice" }
          ],
          "example": "$DefaultNetstreamDriver gtls",
          "tags": ["TLS", "s√©curit√©"]
        },
        {
          "key": "$DefaultNetstreamDriverCAFile",
          "displayName": "Certificat CA",
          "description": "Chemin vers le certificat de l'autorit√© de certification",
          "dataType": "Path",
          "example": "$DefaultNetstreamDriverCAFile /etc/rsyslog.d/ca.pem",
          "tags": ["TLS", "certificat"]
        },
        {
          "key": "$DefaultNetstreamDriverCertFile",
          "displayName": "Certificat serveur",
          "description": "Chemin vers le certificat du serveur",
          "dataType": "Path",
          "example": "$DefaultNetstreamDriverCertFile /etc/rsyslog.d/cert.pem",
          "tags": ["TLS", "certificat"]
        },
        {
          "key": "$DefaultNetstreamDriverKeyFile",
          "displayName": "Cl√© priv√©e",
          "description": "Chemin vers la cl√© priv√©e du serveur",
          "dataType": "Path",
          "example": "$DefaultNetstreamDriverKeyFile /etc/rsyslog.d/key.pem",
          "tags": ["TLS", "certificat"]
        },
        {
          "key": "$ActionSendStreamDriverMode",
          "displayName": "Mode TLS sortant",
          "description": "Active TLS pour les connexions sortantes",
          "dataType": "Enum",
          "enumValues": [
            { "value": "0", "displayName": "D√©sactiv√©", "severity": "Warning" },
            { "value": "1", "displayName": "Activ√©", "severity": "GoodPractice" }
          ],
          "example": "$ActionSendStreamDriverMode 1",
          "tags": ["TLS", "sortant"]
        },
        {
          "key": "$ActionSendStreamDriverAuthMode",
          "displayName": "Auth TLS sortante",
          "description": "Mode d'authentification TLS pour les connexions sortantes",
          "dataType": "Enum",
          "enumValues": [
            { "value": "anon", "displayName": "Anonyme", "severity": "Warning" },
            { "value": "x509/name", "displayName": "Certificat X.509", "severity": "GoodPractice" },
            { "value": "x509/fingerprint", "displayName": "Empreinte X.509", "severity": "GoodPractice" }
          ],
          "example": "$ActionSendStreamDriverAuthMode x509/name",
          "tags": ["TLS", "authentification"]
        }
      ]
    },
    {
      "name": "Inclusions",
      "description": "Inclusion de fichiers de configuration",
      "icon": "üìé",
      "order": 8,
      "parameters": [
        {
          "key": "$IncludeConfig",
          "displayName": "Inclure configuration",
          "description": "Inclut des fichiers de configuration additionnels",
          "dataType": "Path",
          "defaultValue": "/etc/rsyslog.d/*.conf",
          "example": "$IncludeConfig /etc/rsyslog.d/*.conf",
          "tags": ["include"]
        }
      ]
    }
  ]
}
