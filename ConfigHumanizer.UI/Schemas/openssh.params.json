{
  "formatName": "OpenSSH",
  "description": "Configuration du serveur SSH (sshd_config)",
  "version": "1.0",
  "filePatterns": ["*sshd_config", "sshd_config"],
  "fileExtensions": [],
  "syntax": "SpaceSeparated",
  "commentChar": "#",
  "keyValueSeparator": " ",
  "documentationUrl": "https://man.openbsd.org/sshd_config",
  "parameterCategories": [
    {
      "name": "Authentification",
      "description": "Param√®tres d'authentification des utilisateurs",
      "icon": "üîê",
      "order": 1,
      "parameters": [
        {
          "key": "PermitRootLogin",
          "displayName": "Connexion Root",
          "description": "Contr√¥le si l'utilisateur root peut se connecter via SSH. Pour la s√©curit√©, utilisez 'no' ou 'prohibit-password'.",
          "dataType": "Enum",
          "defaultValue": "prohibit-password",
          "enumValues": [
            { "value": "yes", "displayName": "Oui (non recommand√©)", "description": "Autorise la connexion root avec mot de passe", "severity": "CriticalSecurity" },
            { "value": "no", "displayName": "Non", "description": "Interdit toute connexion root", "severity": "GoodPractice" },
            { "value": "prohibit-password", "displayName": "Cl√© uniquement", "description": "Autorise root seulement avec cl√© SSH", "severity": "GoodPractice" },
            { "value": "forced-commands-only", "displayName": "Commandes forc√©es", "description": "Root uniquement pour commandes sp√©cifiques", "severity": "Info" }
          ],
          "securityLevel": "CriticalSecurity",
          "tags": ["s√©curit√©", "root", "authentification"]
        },
        {
          "key": "PasswordAuthentication",
          "displayName": "Authentification par mot de passe",
          "description": "Autorise l'authentification par mot de passe. D√©sactivez pour forcer l'utilisation de cl√©s SSH.",
          "dataType": "Boolean",
          "defaultValue": true,
          "booleanFormat": "yes/no",
          "enumValues": [
            { "value": "yes", "displayName": "Activ√©", "severity": "Warning" },
            { "value": "no", "displayName": "D√©sactiv√© (recommand√©)", "severity": "GoodPractice" }
          ],
          "securityLevel": "Warning",
          "tags": ["s√©curit√©", "mot de passe"]
        },
        {
          "key": "PubkeyAuthentication",
          "displayName": "Authentification par cl√© publique",
          "description": "Active l'authentification par cl√© SSH. Fortement recommand√© pour la s√©curit√©.",
          "dataType": "Boolean",
          "defaultValue": true,
          "booleanFormat": "yes/no",
          "enumValues": [
            { "value": "yes", "displayName": "Activ√© (recommand√©)", "severity": "GoodPractice" },
            { "value": "no", "displayName": "D√©sactiv√©", "severity": "Warning" }
          ],
          "tags": ["s√©curit√©", "cl√© SSH"]
        },
        {
          "key": "MaxAuthTries",
          "displayName": "Tentatives d'authentification max",
          "description": "Nombre maximum de tentatives d'authentification par connexion. R√©duisez pour limiter les attaques brute-force.",
          "dataType": "Integer",
          "defaultValue": 6,
          "validation": {
            "min": 1,
            "max": 20,
            "errorMessage": "La valeur doit √™tre entre 1 et 20"
          },
          "tags": ["s√©curit√©", "brute-force"]
        },
        {
          "key": "MaxSessions",
          "displayName": "Sessions max par connexion",
          "description": "Nombre maximum de sessions shell/login par connexion r√©seau.",
          "dataType": "Integer",
          "defaultValue": 10,
          "validation": {
            "min": 1,
            "max": 100
          }
        },
        {
          "key": "LoginGraceTime",
          "displayName": "D√©lai d'authentification",
          "description": "Temps accord√© pour s'authentifier avant d√©connexion (en secondes, 0 = illimit√©).",
          "dataType": "Duration",
          "defaultValue": 120,
          "unit": "s",
          "validation": {
            "min": 0,
            "max": 600
          },
          "example": "60"
        },
        {
          "key": "PermitEmptyPasswords",
          "displayName": "Mots de passe vides",
          "description": "Autorise les comptes avec mots de passe vides. Toujours d√©sactiver pour la s√©curit√©.",
          "dataType": "Boolean",
          "defaultValue": false,
          "booleanFormat": "yes/no",
          "enumValues": [
            { "value": "yes", "displayName": "Autoris√© (dangereux)", "severity": "CriticalSecurity" },
            { "value": "no", "displayName": "Interdit (recommand√©)", "severity": "GoodPractice" }
          ],
          "securityLevel": "CriticalSecurity"
        },
        {
          "key": "ChallengeResponseAuthentication",
          "displayName": "Authentification challenge-response",
          "description": "Active l'authentification challenge-response (PAM). G√©n√©ralement d√©sactiv√© si vous utilisez des cl√©s SSH.",
          "dataType": "Boolean",
          "defaultValue": false,
          "booleanFormat": "yes/no"
        },
        {
          "key": "UsePAM",
          "displayName": "Utiliser PAM",
          "description": "Active l'interface PAM pour l'authentification. N√©cessaire pour certaines fonctionnalit√©s syst√®me.",
          "dataType": "Boolean",
          "defaultValue": true,
          "booleanFormat": "yes/no"
        }
      ]
    },
    {
      "name": "R√©seau",
      "description": "Param√®tres r√©seau et connexion",
      "icon": "üåê",
      "order": 2,
      "parameters": [
        {
          "key": "Port",
          "displayName": "Port d'√©coute",
          "description": "Port TCP sur lequel le serveur SSH √©coute. Le port par d√©faut 22 est souvent cibl√© par les scans.",
          "dataType": "Port",
          "defaultValue": 22,
          "validation": {
            "min": 1,
            "max": 65535
          },
          "example": "2222",
          "tags": ["r√©seau", "port"]
        },
        {
          "key": "ListenAddress",
          "displayName": "Adresse d'√©coute",
          "description": "Adresse IP sur laquelle le serveur √©coute. 0.0.0.0 = toutes les interfaces.",
          "dataType": "IpAddress",
          "defaultValue": "0.0.0.0",
          "example": "192.168.1.100",
          "tags": ["r√©seau", "IP"]
        },
        {
          "key": "AddressFamily",
          "displayName": "Famille d'adresses",
          "description": "Type d'adresses IP √† utiliser (IPv4, IPv6 ou les deux).",
          "dataType": "Enum",
          "defaultValue": "any",
          "enumValues": [
            { "value": "any", "displayName": "Tous (IPv4 + IPv6)", "severity": "Info" },
            { "value": "inet", "displayName": "IPv4 uniquement", "severity": "Info" },
            { "value": "inet6", "displayName": "IPv6 uniquement", "severity": "Info" }
          ]
        },
        {
          "key": "TCPKeepAlive",
          "displayName": "TCP Keep-Alive",
          "description": "Envoie des messages TCP keep-alive pour d√©tecter les connexions mortes.",
          "dataType": "Boolean",
          "defaultValue": true,
          "booleanFormat": "yes/no"
        },
        {
          "key": "ClientAliveInterval",
          "displayName": "Intervalle client alive",
          "description": "Intervalle en secondes entre les messages de v√©rification client (0 = d√©sactiv√©).",
          "dataType": "Integer",
          "defaultValue": 0,
          "unit": "s",
          "validation": {
            "min": 0,
            "max": 3600
          },
          "example": "60"
        },
        {
          "key": "ClientAliveCountMax",
          "displayName": "Nombre max de v√©rifications client",
          "description": "Nombre de messages client alive avant d√©connexion si pas de r√©ponse.",
          "dataType": "Integer",
          "defaultValue": 3,
          "validation": {
            "min": 0,
            "max": 100
          }
        }
      ]
    },
    {
      "name": "Transfert",
      "description": "Param√®tres de transfert de ports et X11",
      "icon": "üîÄ",
      "order": 3,
      "parameters": [
        {
          "key": "AllowTcpForwarding",
          "displayName": "Transfert TCP",
          "description": "Autorise le transfert de ports TCP. D√©sactivez si non n√©cessaire pour r√©duire la surface d'attaque.",
          "dataType": "Enum",
          "defaultValue": "yes",
          "enumValues": [
            { "value": "yes", "displayName": "Activ√©", "severity": "Warning" },
            { "value": "no", "displayName": "D√©sactiv√©", "severity": "GoodPractice" },
            { "value": "local", "displayName": "Local uniquement", "severity": "Info" },
            { "value": "remote", "displayName": "Distant uniquement", "severity": "Info" }
          ],
          "tags": ["tunnel", "port forwarding"]
        },
        {
          "key": "X11Forwarding",
          "displayName": "Transfert X11",
          "description": "Autorise le transfert X11 pour les applications graphiques. D√©sactivez sur les serveurs.",
          "dataType": "Boolean",
          "defaultValue": false,
          "booleanFormat": "yes/no",
          "enumValues": [
            { "value": "yes", "displayName": "Activ√©", "severity": "Warning" },
            { "value": "no", "displayName": "D√©sactiv√© (recommand√©)", "severity": "GoodPractice" }
          ],
          "tags": ["X11", "graphique"]
        },
        {
          "key": "GatewayPorts",
          "displayName": "Ports passerelle",
          "description": "Autorise les h√¥tes distants √† se connecter aux ports transf√©r√©s locaux.",
          "dataType": "Boolean",
          "defaultValue": false,
          "booleanFormat": "yes/no",
          "enumValues": [
            { "value": "yes", "displayName": "Activ√©", "severity": "Warning" },
            { "value": "no", "displayName": "D√©sactiv√© (recommand√©)", "severity": "GoodPractice" }
          ]
        },
        {
          "key": "PermitTunnel",
          "displayName": "Tunnels VPN",
          "description": "Autorise les tunnels de p√©riph√©rique (VPN layer 2/3).",
          "dataType": "Enum",
          "defaultValue": "no",
          "enumValues": [
            { "value": "yes", "displayName": "Tous", "severity": "Warning" },
            { "value": "no", "displayName": "Aucun", "severity": "GoodPractice" },
            { "value": "point-to-point", "displayName": "Point-to-point", "severity": "Info" },
            { "value": "ethernet", "displayName": "Ethernet", "severity": "Info" }
          ]
        },
        {
          "key": "AllowAgentForwarding",
          "displayName": "Transfert agent SSH",
          "description": "Autorise le transfert de l'agent SSH pour l'authentification en cascade.",
          "dataType": "Boolean",
          "defaultValue": true,
          "booleanFormat": "yes/no",
          "enumValues": [
            { "value": "yes", "displayName": "Activ√©", "severity": "Info" },
            { "value": "no", "displayName": "D√©sactiv√©", "severity": "Info" }
          ]
        }
      ]
    },
    {
      "name": "S√©curit√© Avanc√©e",
      "description": "Param√®tres de s√©curit√© avanc√©s",
      "icon": "üõ°Ô∏è",
      "order": 4,
      "parameters": [
        {
          "key": "Protocol",
          "displayName": "Version du protocole",
          "description": "Version du protocole SSH. La version 1 est obsol√®te et non s√©curis√©e.",
          "dataType": "Integer",
          "defaultValue": 2,
          "validation": {
            "min": 2,
            "max": 2,
            "errorMessage": "Seul le protocole version 2 est support√© et s√©curis√©"
          },
          "securityLevel": "CriticalSecurity"
        },
        {
          "key": "StrictModes",
          "displayName": "Mode strict",
          "description": "V√©rifie les permissions des fichiers de configuration et du r√©pertoire home avant l'authentification.",
          "dataType": "Boolean",
          "defaultValue": true,
          "booleanFormat": "yes/no",
          "enumValues": [
            { "value": "yes", "displayName": "Activ√© (recommand√©)", "severity": "GoodPractice" },
            { "value": "no", "displayName": "D√©sactiv√©", "severity": "Warning" }
          ]
        },
        {
          "key": "HostbasedAuthentication",
          "displayName": "Authentification bas√©e sur l'h√¥te",
          "description": "Autorise l'authentification bas√©e sur le nom d'h√¥te. G√©n√©ralement non recommand√©.",
          "dataType": "Boolean",
          "defaultValue": false,
          "booleanFormat": "yes/no",
          "enumValues": [
            { "value": "yes", "displayName": "Activ√©", "severity": "Warning" },
            { "value": "no", "displayName": "D√©sactiv√© (recommand√©)", "severity": "GoodPractice" }
          ]
        },
        {
          "key": "IgnoreRhosts",
          "displayName": "Ignorer .rhosts",
          "description": "Ignore les fichiers ~/.rhosts et ~/.shosts pour l'authentification bas√©e sur l'h√¥te.",
          "dataType": "Boolean",
          "defaultValue": true,
          "booleanFormat": "yes/no",
          "enumValues": [
            { "value": "yes", "displayName": "Ignorer (recommand√©)", "severity": "GoodPractice" },
            { "value": "no", "displayName": "Utiliser", "severity": "Warning" }
          ]
        },
        {
          "key": "PermitUserEnvironment",
          "displayName": "Variables d'environnement utilisateur",
          "description": "Autorise les utilisateurs √† d√©finir des variables d'environnement. Peut poser des risques de s√©curit√©.",
          "dataType": "Boolean",
          "defaultValue": false,
          "booleanFormat": "yes/no",
          "enumValues": [
            { "value": "yes", "displayName": "Autoris√©", "severity": "Warning" },
            { "value": "no", "displayName": "Interdit (recommand√©)", "severity": "GoodPractice" }
          ]
        }
      ]
    },
    {
      "name": "Chiffrement",
      "description": "Algorithmes de chiffrement et √©change de cl√©s",
      "icon": "üîí",
      "order": 5,
      "parameters": [
        {
          "key": "Ciphers",
          "displayName": "Algorithmes de chiffrement",
          "description": "Liste des algorithmes de chiffrement accept√©s. Utilisez des algorithmes modernes uniquement.",
          "dataType": "String",
          "defaultValue": "chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com",
          "example": "chacha20-poly1305@openssh.com,aes256-gcm@openssh.com",
          "multiValue": true,
          "multiValueSeparator": ",",
          "tags": ["chiffrement", "crypto"]
        },
        {
          "key": "MACs",
          "displayName": "Algorithmes MAC",
          "description": "Algorithmes de code d'authentification de message accept√©s.",
          "dataType": "String",
          "defaultValue": "hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com",
          "example": "hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com",
          "multiValue": true,
          "multiValueSeparator": ",",
          "tags": ["MAC", "int√©grit√©"]
        },
        {
          "key": "KexAlgorithms",
          "displayName": "Algorithmes d'√©change de cl√©s",
          "description": "Algorithmes d'√©change de cl√©s accept√©s.",
          "dataType": "String",
          "defaultValue": "curve25519-sha256,curve25519-sha256@libssh.org",
          "example": "curve25519-sha256,diffie-hellman-group16-sha512",
          "multiValue": true,
          "multiValueSeparator": ",",
          "tags": ["KEX", "Diffie-Hellman"]
        }
      ]
    },
    {
      "name": "Journalisation",
      "description": "Param√®tres de logging et audit",
      "icon": "üìù",
      "order": 6,
      "parameters": [
        {
          "key": "LogLevel",
          "displayName": "Niveau de log",
          "description": "Verbosit√© des messages de log. INFO est recommand√© pour la plupart des cas.",
          "dataType": "Enum",
          "defaultValue": "INFO",
          "enumValues": [
            { "value": "QUIET", "displayName": "Silencieux", "severity": "Warning" },
            { "value": "FATAL", "displayName": "Fatal uniquement", "severity": "Info" },
            { "value": "ERROR", "displayName": "Erreurs", "severity": "Info" },
            { "value": "INFO", "displayName": "Info (recommand√©)", "severity": "GoodPractice" },
            { "value": "VERBOSE", "displayName": "Verbeux", "severity": "Info" },
            { "value": "DEBUG", "displayName": "Debug", "severity": "Info" },
            { "value": "DEBUG1", "displayName": "Debug 1", "severity": "Info" },
            { "value": "DEBUG2", "displayName": "Debug 2", "severity": "Info" },
            { "value": "DEBUG3", "displayName": "Debug 3", "severity": "Info" }
          ],
          "tags": ["log", "audit"]
        },
        {
          "key": "SyslogFacility",
          "displayName": "Facility Syslog",
          "description": "Facility syslog utilis√©e pour les messages de log.",
          "dataType": "Enum",
          "defaultValue": "AUTH",
          "enumValues": [
            { "value": "DAEMON", "displayName": "DAEMON", "severity": "Info" },
            { "value": "USER", "displayName": "USER", "severity": "Info" },
            { "value": "AUTH", "displayName": "AUTH (recommand√©)", "severity": "GoodPractice" },
            { "value": "LOCAL0", "displayName": "LOCAL0", "severity": "Info" },
            { "value": "LOCAL1", "displayName": "LOCAL1", "severity": "Info" },
            { "value": "LOCAL2", "displayName": "LOCAL2", "severity": "Info" },
            { "value": "LOCAL3", "displayName": "LOCAL3", "severity": "Info" },
            { "value": "LOCAL4", "displayName": "LOCAL4", "severity": "Info" },
            { "value": "LOCAL5", "displayName": "LOCAL5", "severity": "Info" },
            { "value": "LOCAL6", "displayName": "LOCAL6", "severity": "Info" },
            { "value": "LOCAL7", "displayName": "LOCAL7", "severity": "Info" }
          ]
        }
      ]
    },
    {
      "name": "Acc√®s",
      "description": "Contr√¥le d'acc√®s utilisateurs et groupes",
      "icon": "üë•",
      "order": 7,
      "parameters": [
        {
          "key": "AllowUsers",
          "displayName": "Utilisateurs autoris√©s",
          "description": "Liste des utilisateurs autoris√©s √† se connecter. Supporte les patterns avec wildcards.",
          "dataType": "String",
          "example": "admin deploy@192.168.1.*",
          "multiValue": true,
          "multiValueSeparator": " ",
          "tags": ["acc√®s", "utilisateurs"]
        },
        {
          "key": "DenyUsers",
          "displayName": "Utilisateurs interdits",
          "description": "Liste des utilisateurs interdits de connexion.",
          "dataType": "String",
          "example": "guest test",
          "multiValue": true,
          "multiValueSeparator": " ",
          "tags": ["acc√®s", "utilisateurs"]
        },
        {
          "key": "AllowGroups",
          "displayName": "Groupes autoris√©s",
          "description": "Liste des groupes dont les membres peuvent se connecter.",
          "dataType": "String",
          "example": "sshusers admins",
          "multiValue": true,
          "multiValueSeparator": " ",
          "tags": ["acc√®s", "groupes"]
        },
        {
          "key": "DenyGroups",
          "displayName": "Groupes interdits",
          "description": "Liste des groupes dont les membres ne peuvent pas se connecter.",
          "dataType": "String",
          "example": "noremote",
          "multiValue": true,
          "multiValueSeparator": " ",
          "tags": ["acc√®s", "groupes"]
        }
      ]
    },
    {
      "name": "Banni√®re",
      "description": "Messages et banni√®res",
      "icon": "üí¨",
      "order": 8,
      "parameters": [
        {
          "key": "Banner",
          "displayName": "Fichier banni√®re",
          "description": "Chemin vers un fichier contenant un message affich√© avant l'authentification.",
          "dataType": "Path",
          "defaultValue": "none",
          "example": "/etc/ssh/banner.txt",
          "tags": ["banni√®re", "message"]
        },
        {
          "key": "PrintMotd",
          "displayName": "Afficher MOTD",
          "description": "Affiche le message du jour (/etc/motd) apr√®s connexion.",
          "dataType": "Boolean",
          "defaultValue": true,
          "booleanFormat": "yes/no"
        },
        {
          "key": "PrintLastLog",
          "displayName": "Afficher derni√®re connexion",
          "description": "Affiche la date et l'heure de la derni√®re connexion.",
          "dataType": "Boolean",
          "defaultValue": true,
          "booleanFormat": "yes/no"
        }
      ]
    }
  ]
}
